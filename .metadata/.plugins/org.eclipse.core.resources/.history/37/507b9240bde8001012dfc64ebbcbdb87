package com.capstone.assessment.controller;

import com.capstone.assessment.dto.*;
import com.capstone.assessment.entity.Assessment;
import com.capstone.assessment.entity.Question;
import com.capstone.assessment.service.AssessmentService;

import java.util.List;
import java.util.UUID;

import org.springframework.web.bind.annotation.*;

@RestController
@RequestMapping("/api/assessments")
public class AssessmentController {

    private final AssessmentService service;

    public AssessmentController(AssessmentService service) {
        this.service = service;
    }

    // -------- TRAINER --------

    @PostMapping("/course/{courseId}")
    public Assessment createAssessment(
            @PathVariable UUID courseId,
            @RequestBody CreateAssessmentDTO dto) {
        return service.createAssessment(courseId, dto);
    }
    @GetMapping("/course/assesments")
    public List<Assessment> cassesment() {
    	return service.cassesmment();
    }

    @PostMapping("/{assessmentId}/questions")
    public Question addQuestion(
            @PathVariable UUID assessmentId,
            @RequestBody QuestionCreateDTO dto) {
        return service.addQuestion(assessmentId, dto);
    }
    @DeleteMapping("/{assessmentId}")
    public void deletequestion(@PathVariable UUID assessmentId) {
    	service.deleteQuestion(assessmentId);
    }

    // -------- USER --------

    @GetMapping("/{assessmentId}/questions/user")
    public List<QuestionUserViewDTO> getQuestionsForUser(
            @PathVariable UUID assessmentId) {
        return service.getQuestionsForUser(assessmentId);
    }

    @PostMapping("/attempt")
    public AssessmentResultDTO attemptExam(
            @RequestBody AssessmentAttemptRequestDTO dto) {
        return service.attemptExam(dto);
    }
}

